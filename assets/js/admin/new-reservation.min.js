jQuery(function(n){"use strict";var o={init:function(){this.add_room(),this.remove_room(),this.datepicker()},clone_room_row:function(e){var o,t=1;e.parent().find(".add-new-room-row").each(function(){var e=n(this).data("key");parseInt(e,10)>t&&(t=e)}),o=t+=1;var r=e.clone();return r.attr("data-key",o),r.find("input").val(1),r.find("input, select").each(function(){var e=n(this),t=e.attr("name");t&&(t=t.replace(/\[(\d+)\](?!.*\[\d+\])/,"["+parseInt(o,10)+"]"),e.attr("name",t))}),r},add_room:function(){n("form.add-new-reservation-form").on("click",".add-new-room",function(e){e.preventDefault();var t=n(this).parent().find(".add-new-room-row").last();o.clone_room_row(t).insertAfter(t),n("button.remove-room").prop("disabled",!1)})},remove_room:function(){n("form.add-new-reservation-form").on("click",".remove-room",function(e){e.preventDefault();var t=n(this),o=t.parent(),r=t.closest("td").find(".add-new-room-row").length;1<r&&(n("input",o).val(""),o.fadeOut("fast").remove()),2===r&&n("button.remove-room").prop("disabled",!0)})},datepicker:function(){var e=n("form.add-new-reservation-form").find(".date-from"),t=n("form.add-new-reservation-form").find(".date-to");e.datepicker({dateFormat:"yy-mm-dd",minDate:0,changeMonth:!0,onClose:function(){var e=n(this).datepicker("getDate");e&&(e.setDate(e.getDate()+1),t.datepicker("option","minDate",e))}}),t.datepicker({dateFormat:"yy-mm-dd",minDate:1,changeMonth:!0})}};n(document).ready(function(){o.init()})});